#!/bin/bash

# Configs (Prefix with Plugin name)

# Plugin configs
COMPOSER_VERSION=1.0.0
COMPOSER_COMMAND="composer"
COMPOSER_FUNCTION="composerRun"
COMPOSER_HELP="composerHelp"

# Default configs
COMPOSER_ENABLED=true
COMPOSER_PATH=/
COMPOSER_VERSION=latest

# Run Composer command inside docker container
function composerRun {

	if ! [ COMPOSER_ENABLED ]; then
		message "ERROR" "Composer is disabled on this project."
	fi
	
	COMPOSE_FULL_PATH=$(pwd)$COMPOSER_PATH

	$COMMAND_PREFIX docker run --rm --interactive --tty --user $USER:$GROUP --volume $PATH_PREFIX$COMPOSE_FULL_PATH:/app --volume $PATH_PREFIX$SSHKEYPATH:/home/$USER/.ssh composer:$COMPOSER_VERSION $@
	debug "Finished running composer"
}

# Function for output top level help
function composerHelp {
	printf "   composer\t\tRun set version of composer inside a docker container."
}